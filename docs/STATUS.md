# Текущее состояние реализации

## Что уже сделано
- **NOS-Ledger**: хранение балансов аккаунтов и бюджетов, применение мутаций, журнал событий и расчёт меркл-корня состояния. Обрабатываются эмиссия, переводы, пополнение и траты бюджетов, а также реферальные выплаты.
- **Контракты PoC**: описание контракта с бюджетом и конфигурацией рефералов, дерево спонсорств, расчёт выплат по уровням и генерация мутаций для операций пополнения и выполнения работы.
- **Квитанции PoC**: форматы `receipt{scid, merkle_root, ct_hash, outcome}`, вычисление дайджеста, проверки кворума комитета и ошибок в подписях, упаковка мутаций и заметок.

## Как этим пользоваться сейчас
- Вызывать `ContractDefinition::apply_action` для получения мутаций, которые нужно применить к леджеру в ответ на действия контракта (пополнение бюджета или выполнение работы).
- Передавать полученные мутации в `LedgerState::apply_mutations`, чтобы обновить состояние, журнал событий и меркл-корень, сохранив идентификатор квитанции.
- Проверять квитанции через `CommitteeConfig::verify`, чтобы убедиться, что достигнут кворум подписей перед применением мутаций.

## Следующий шаг
- Подготовить сервисный слой (Step 4 плана) с REST/JSON-RPC обёрткой над существующими функциями `pack/verify/unpack/fountain`, чтобы внешние клиенты и будущий веб-интерфейс могли использовать леджер, контракты и квитанции без прямого доступа к внутренним структурам.
